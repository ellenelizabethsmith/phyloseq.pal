% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting.R
\name{plot_taxa}
\alias{plot_taxa}
\title{Plot abundance of selected taxa across a variable}
\usage{
plot_taxa(
  ps,
  tax_rank,
  taxa_list,
  x,
  color = NULL,
  plot_type = c("line", "point", "box", "bar"),
  shared_y = FALSE
)
}
\arguments{
\item{ps}{A \code{\link[phyloseq:phyloseq]{phyloseq::phyloseq}} object.}

\item{tax_rank}{A character string specifying the taxonomic rank to plot.
Must be one of: \code{"Kingdom"}, \code{"Phylum"}, \code{"Class"}, \code{"Order"},
\code{"Family"}, \code{"Genus"}, \code{"Species"}.}

\item{taxa_list}{A character vector of taxa names (matching the chosen
\code{tax_rank}) to include in the plot.}

\item{x}{A character string giving the name of a sample variable to plot
on the x-axis (e.g., \code{"SampleType"}, \code{"Time"}).}

\item{color}{(Optional) A character string giving the name of a sample
variable used to color and group the geoms.}

\item{plot_type}{Type of plot. One of \code{"line"}, \code{"point"}, \code{"box"}, \code{"bar"}.
\itemize{
\item \code{"line"}: mean ± SE connected by lines
\item \code{"point"}: mean ± SE shown as points only
\item \code{"box"}: boxplots of raw abundances
\item \code{"bar"}: barplots of means ± SE
}}
}
\value{
A \code{\link[ggplot2:ggplot]{ggplot2::ggplot}} object.
}
\description{
This function summarizes and plots the relative abundance of selected taxa
at a specified taxonomic rank, optionally stratified by a grouping variable
(e.g., environment, treatment, subject). It supports several plot types:
line plots (means ± SE), bar plots (means ± SE), boxplots (distribution),
and points at group means.
}
\details{
Taxonomy is first agglomerated to the specified \code{tax_rank} using
\code{\link[speedyseq:tax_glom]{speedyseq::tax_glom()}}, then melted into long format with
\code{\link[speedyseq:psmelt]{speedyseq::psmelt()}}. Depending on \code{plot_type}, either raw values are used
(\code{"box"}) or group summaries (mean ± SE) are computed across groups defined
by \code{x} and optionally \code{color}.
}
\examples{
library(phyloseq)
library(speedyseq)
data("GlobalPatterns")
#'
# Line plot
plot_taxa(GlobalPatterns, "Family", c("Lachnospiraceae", "Ruminococcaceae", "Bacteroidaceae"), x = "SampleType", plot_type = "line")

# Boxplot
plot_taxa(GlobalPatterns, "Family", c("Lachnospiraceae", "Ruminococcaceae", "Bacteroidaceae"), x = "SampleType", plot_type = "box")

}
